### JSONPlaceholder API Examples
### https://jsonplaceholder.typicode.com

@baseUrl = https://jsonplaceholder.typicode.com

###############################################################################
# POSTS
###############################################################################

### Get all posts
# @name getPost
GET {{baseUrl}}/posts
Accept: application/json

### Get a single post
# @name getPost
GET {{baseUrl}}/posts/1
Accept: application/json

### Create a new post
# @name createPost
POST {{baseUrl}}/posts
Content-Type: application/json

{
    "title": "My New Post",
    "body": "This is the content of my new post created at {{$datetime iso8601}}",
    "userId": 1
}

### Update a post (PUT - full replacement)
# @name updatePost
PUT {{baseUrl}}/posts/1
Content-Type: application/json

{
    "id": 1,
    "title": "Updated Post Title",
    "body": "This post has been fully updated",
    "userId": 1
}

### Partial update a post (PATCH)
# @name patchPost
PATCH {{baseUrl}}/posts/1
Content-Type: application/json

{
    "title": "Patched Title Only"
}

### Delete a post
# @name deletePost
DELETE {{baseUrl}}/posts/1

### Get posts by user (query parameter)
# @name getPostsByUser
GET {{baseUrl}}/posts
    ?userId=1
Accept: application/json

###############################################################################
# COMMENTS
###############################################################################

### Get all comments for a post
# @name getComments
GET {{baseUrl}}/posts/1/comments
Accept: application/json

### Get comments using query parameter
# @name getCommentsByPost
GET {{baseUrl}}/comments?postId=1
Accept: application/json

### Create a comment
# @name createComment
POST {{baseUrl}}/comments
Content-Type: application/json

{
    "postId": 1,
    "name": "My Comment",
    "email": "user@example.com",
    "body": "This is a great post! Comment ID: {{$guid}}"
}

###############################################################################
# USERS
###############################################################################

### Get all users
# @name getAllUsers
GET {{baseUrl}}/users
Accept: application/json

### Get a single user
# @name getUser
GET {{baseUrl}}/users/1
Accept: application/json

### Create a new user
# @name createUser
POST {{baseUrl}}/users
Content-Type: application/json

{
    "name": "John Doe",
    "username": "johndoe_{{$randomInt 1000 9999}}",
    "email": "john.doe@example.com",
    "address": {
        "street": "123 Main St",
        "suite": "Apt 4",
        "city": "New York",
        "zipcode": "10001",
        "geo": {
            "lat": "40.7128",
            "lng": "-74.0060"
        }
    },
    "phone": "1-234-567-8900",
    "website": "johndoe.com",
    "company": {
        "name": "Doe Industries",
        "catchPhrase": "Innovation at its finest",
        "bs": "synergize scalable solutions"
    }
}

###############################################################################
# TODOS
###############################################################################

### Get all todos
# @name getAllTodos
GET {{baseUrl}}/todos
Accept: application/json

### Get todos for a specific user
# @name getTodosByUser
GET {{baseUrl}}/todos?userId=1
Accept: application/json

### Get a single todo
# @name getTodo
GET {{baseUrl}}/todos/1
Accept: application/json

### Create a todo
# @name createTodo
POST {{baseUrl}}/todos
Content-Type: application/json

{
    "userId": 1,
    "title": "Learn to use rest-client CLI - {{$datetime iso8601}}",
    "completed": false
}

### Mark todo as completed
# @name completeTodo
PATCH {{baseUrl}}/todos/1
Content-Type: application/json

{
    "completed": true
}

###############################################################################
# ALBUMS & PHOTOS
###############################################################################

### Get all albums
# @name getAllAlbums
GET {{baseUrl}}/albums
Accept: application/json

### Get albums for a user
# @name getAlbumsByUser
GET {{baseUrl}}/albums?userId=1
Accept: application/json

### Get photos in an album
# @name getPhotosByAlbum
GET {{baseUrl}}/albums/1/photos
Accept: application/json

### Get a single photo
# @name getPhoto
GET {{baseUrl}}/photos/1
Accept: application/json

###############################################################################
# NESTED RESOURCES
###############################################################################

### Get user's posts
# @name getUserPosts
GET {{baseUrl}}/users/1/posts
Accept: application/json

### Get user's todos
# @name getUserTodos
GET {{baseUrl}}/users/1/todos
Accept: application/json

### Get user's albums
# @name getUserAlbums
GET {{baseUrl}}/users/1/albums
Accept: application/json

###############################################################################
# SCRIPTING EXAMPLES
###############################################################################

### Get post with tests
# @name getPostWithTests
GET {{baseUrl}}/posts/1
Accept: application/json

> {%
client.test("Status is 200", function() {
    client.assert(response.status === 200, "Expected status 200");
});

client.test("Response has id", function() {
    client.assert(response.body.id === 1, "Expected id to be 1");
});

client.test("Response has title", function() {
    client.assert(response.body.title !== undefined, "Expected title to exist");
});

// Log some information
client.log("Post title: " + response.body.title);

// Store post ID for later use
client.global.set("postId", response.body.id);
%}

### Create post and verify response
# @name createPostWithTests
POST {{baseUrl}}/posts
Content-Type: application/json

{
    "title": "Test Post",
    "body": "This is a test post",
    "userId": 1
}

> {%
client.test("Status is 201", function() {
    client.assert(response.status === 201, "Expected status 201 for created resource");
});

client.test("Response contains id", function() {
    client.assert(response.body.id !== undefined, "Expected response to have an id");
});

client.test("Title matches", function() {
    client.assert(response.body.title === "Test Post", "Title should match");
});

// Store the created post ID
client.global.set("createdPostId", response.body.id);
client.log("Created post with ID: " + response.body.id);
%}

### Get users with content type validation
# @name getUsersWithContentTypeCheck
GET {{baseUrl}}/users
Accept: application/json

> {%
client.test("Status is 200", function() {
    client.assert(response.status === 200);
});

client.test("Content-Type is JSON", function() {
    var contentType = response.headers.valueOf("Content-Type");
    client.assert(contentType.includes("application/json"), "Expected JSON content type");
});

client.test("Response is an array", function() {
    client.assert(Array.isArray(response.body), "Expected response to be an array");
});

client.test("Has at least one user", function() {
    client.assert(response.body.length > 0, "Expected at least one user");
});

// Log user count
client.log("Found " + response.body.length + " users");
%}

### Pre-request script example
# @name preRequestExample
< {%
// This runs before the request is sent
client.log("Preparing request...");
var timestamp = Date.now();
client.global.set("requestTimestamp", timestamp);
%}
GET {{baseUrl}}/posts/1
Accept: application/json

> {%
client.test("Request was successful", function() {
    client.assert(response.status === 200);
});

client.log("Request completed");
%}

###############################################################################
# UTILITY FUNCTIONS EXAMPLES
###############################################################################

### Using built-in utility functions
# @name utilityFunctionsDemo
< {%
// Generate unique request ID
var requestId = $uuid();
client.global.set("requestId", requestId);
client.log("Request ID: " + requestId);

// Generate timestamp
var ts = $timestamp();
client.log("Timestamp: " + ts);

// ISO timestamp
var isoTs = $isoTimestamp();
client.log("ISO Timestamp: " + isoTs);
%}
POST {{baseUrl}}/posts
Content-Type: application/json
X-Request-ID: {{requestId}}

{
    "title": "Post with UUID",
    "body": "This post was created with a unique request ID",
    "userId": 1
}

> {%
client.test("Post created successfully", function() {
    client.assert(response.status === 201);
});

// Hash the response body
var bodyHash = $sha256(JSON.stringify(response.body));
client.log("Response hash: " + bodyHash);

// Generate a random session token
var sessionToken = $randomString(32);
client.global.set("sessionToken", sessionToken);
client.log("Session token: " + sessionToken);
%}

### Base64 encoding/decoding example
# @name base64Example
< {%
// Encode credentials for Basic auth simulation
var credentials = "username:password";
var encoded = $base64(credentials);
client.global.set("encodedCredentials", encoded);
client.log("Encoded: " + encoded);

// Decode to verify
var decoded = $base64Decode(encoded);
client.log("Decoded: " + decoded);
%}
GET {{baseUrl}}/users/1
Accept: application/json

> {%
client.test("Status is 200", function() {
    client.assert(response.status === 200);
});
%}

### Hashing example
# @name hashingExample
GET {{baseUrl}}/posts/1
Accept: application/json

> {%
// Hash the response for integrity checking
var bodyStr = JSON.stringify(response.body);

var md5Hash = $md5(bodyStr);
var sha256Hash = $sha256(bodyStr);
var sha512Hash = $sha512(bodyStr);

client.log("MD5: " + md5Hash);
client.log("SHA256: " + sha256Hash);
client.log("SHA512 (first 32 chars): " + sha512Hash.substring(0, 32) + "...");

// Store hashes for comparison
client.global.set("responseHash", sha256Hash);

client.test("Response integrity check", function() {
    client.assert(sha256Hash.length === 64, "SHA256 should be 64 chars");
});
%}

### Random values example
# @name randomValuesExample
< {%
// Generate random values for the request
var orderId = $randomInt(10000, 99999);
var verificationCode = $randomString(6);

client.global.set("orderId", orderId);
client.global.set("verificationCode", verificationCode);

client.log("Order ID: " + orderId);
client.log("Verification Code: " + verificationCode);
%}
POST {{baseUrl}}/posts
Content-Type: application/json

{
    "title": "Order #{{orderId}}",
    "body": "Verification code: {{verificationCode}}",
    "userId": 1
}

> {%
client.test("Created with random values", function() {
    client.assert(response.status === 201);
});
%}
